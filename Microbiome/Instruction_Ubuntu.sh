#!/bin/bash
# This script lists the commands to reproduce the key analyses done in the manuscript
# The a minimal set of data to reproduce the analyses is provided
# Random numbers generated may be different
# The exact results generated by the authors are provided in Dryad repository (see GitHub site's description file)

# Part 1. Fitting pulsed evolution models and preparing reference for prediction
# Starting data:  Reference/reference.tre
#                 Reference/16S_GCN.txt
# Expected output:  Reference/homogeneous_data.RDS
#                   Reference/homogeneous_models.RDS
# Fit homogeneous BM and PE models
Rscript fit_homogeneous_models.R Reference/reference.tre Reference/16S_GCN.txt Reference/homogeneous
# Binary partition of the phylogeny
Rscript binary_partition_by_AIC.R Reference/homogeneous_data.RDS Reference/homogeneous_models.RDS Reference/binary_partition.RDS Reference/rescaled_data_model.RDS
# Prepare prediction reference
Rscript prepare_prediction_data.R Reference/rescaled_data_model.RDS Reference/prepared_reference.RDS

